import{c as e}from"./chunks/createFileInfoContent-CCDnJL2i.js";await Promise.allSettled([customElements.whenDefined("sl-button"),customElements.whenDefined("sl-icon"),customElements.whenDefined("sl-icon-button"),customElements.whenDefined("sl-drawer"),customElements.whenDefined("sl-dialog"),customElements.whenDefined("sl-tree"),customElements.whenDefined("sl-tree-item"),customElements.whenDefined("sl-breadcrumb"),customElements.whenDefined("sl-breadcrumb-item")]),document.body.style.display="block";const t=document.getElementById("data-script"),n=JSON.parse(t.textContent),o=document.querySelector("sl-alert");o&&o.toast();const r=document.querySelector(".drawer-overview"),l=document.querySelector(".drawer-content"),d=document.querySelectorAll(".btn.grid-row[data-index]"),i=r.querySelector(".drawer-download-btn"),c=r.querySelector(".drawer-share-btn"),s=r.querySelector(".delete-file-form");r.querySelector(".drawer-close-btn").addEventListener("click",(()=>r.hide()));for(const t of d)t.addEventListener("click",(()=>{const o=t.getAttribute("data-index"),d=n[o],a=e(d);l.replaceChildren(a);const u=d.parentId?`&parentId=${d.parentId}`:"";i.href=`/files/download/${d.id}?filename=${d.name}&mimeType=${d.mimeType}${u}`,i.addEventListener("click",(function(){this.loading=!0,setTimeout((()=>{this.loading=!1}),2e3)})),c.addEventListener("click",(()=>m.show())),g.dataset.filename=d.name,g.dataset.id=d.id,s.action=`/files/${d.id}?_method=DELETE`,r.show()}));const a=document.querySelector(".new-folder-dialog"),u=document.querySelector(".delete-folder-dialog"),m=document.querySelector(".share-dialog"),f=document.querySelector(".share-folder-dialog"),h=document.querySelector(".new-file-dialog"),w=document.querySelectorAll(".new-folder-btn");for(const e of w)e.addEventListener("click",(()=>a.show()));const y=document.querySelectorAll(".new-file-btn");for(const e of y)e.addEventListener("click",(()=>h.show()));const p=document.querySelectorAll(".delete-folder-btn");for(const e of p)e.addEventListener("click",(()=>u.show()));u.querySelector('sl-button[slot="footer"]').addEventListener("click",(()=>u.hide()));document.querySelector(".share-folder-btn").addEventListener("click",(()=>f.show()));f.querySelector('sl-button[slot="footer"]').addEventListener("click",(()=>f.hide()));m.querySelector('sl-button[slot="footer"]').addEventListener("click",(()=>m.hide()));const v=document.querySelector(".upload-progress"),E=document.querySelector(".upload-form"),L=E.querySelector('input[type="file"]'),S=document.getElementById("file-error");L.onchange=function(){this.files[0].size>52428800?(this.value="",S.classList.add("active")):S.classList.remove("active")},E.addEventListener("submit",(e=>{e.preventDefault(),v.classList.add("active");const t=new FormData(E),n=new XMLHttpRequest;n.open(E.method,E.action,!0),n.upload.addEventListener("progress",(e=>{const t=Math.round(e.loaded/e.total*100);v.value=t,100===t&&setTimeout((()=>{v.indeterminate=!0}),1e3)})),n.addEventListener("load",(()=>{if(n.status>=200&&n.status<300){const e=n.responseURL;window.location.href=e}h.hide()})),n.send(t)}));const b=m.querySelector("sl-radio-group"),q=m.querySelectorAll("sl-radio-button"),k=m.querySelector(".share-link-container"),g=m.querySelector("#generate-link-btn");g.addEventListener("click",(async function(){const e=b.value,t=document.createElement("sl-input");t.classList.add("link-input"),g.loading=!0;const n=await fetch(`/share/file/${g.dataset.id}?h=${e}`),o=await n.json();if(o.error)window.alert(o.error),f.hide();else{const e=o.publicUrl;t.value=e,k.appendChild(t),g.loading=!1,g.textContent="Copy Link",g.addEventListener("click",(()=>{navigator.clipboard.writeText(e),g.textContent="Copied!"})),m.addEventListener("sl-after-hide",(()=>{for(const e of q)e.disabled=!1;t.remove(),g.textContent="Generate Link",g.addEventListener("click",A,{once:!0})}),{once:!0})}}),{once:!0});const C=f.querySelector("sl-radio-group"),D=f.querySelectorAll("sl-radio-button"),x=f.querySelector(".share-link-container"),$=f.querySelector("#generate-folder-link-btn");async function A(){const e=C.value,t=document.createElement("sl-input");t.classList.add("link-input"),$.loading=!0;const n=await fetch(`/share/folder/${$.dataset.id}?h=${e}`),o=await n.json();if(o.error)window.alert(o.error),f.hide();else{const e=o.publicUrl;t.value=e,x.appendChild(t),$.loading=!1;for(const e of D)e.disabled=!0;$.textContent="Copy Link",$.addEventListener("click",(()=>{navigator.clipboard.writeText(e),$.textContent="Copied!"})),f.addEventListener("sl-after-hide",(()=>{for(const e of D)e.disabled=!1;t.remove(),$.textContent="Generate Link",$.addEventListener("click",A,{once:!0})}),{once:!0})}}$.addEventListener("click",A,{once:!0});
